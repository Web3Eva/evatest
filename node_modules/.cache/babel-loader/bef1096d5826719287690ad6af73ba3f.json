{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Lahcen Laayouni\\\\Documents\\\\Eva\\\\src\\\\components\\\\MessageInFeed.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport './MessageInFeed.css';\nimport { defaultImgs } from \"../defaultimgs\";\nimport { Icon } from \"web3uikit\";\nimport { useMoralis, useMoralisQuery } from \"react-moralis\";\nimport { useEffect, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst MessageInFeed = _ref => {\n  _s();\n\n  let {\n    profile\n  } = _ref;\n  const [MessageArr, setMessageArr] = useState();\n  const {\n    Moralis,\n    account\n  } = useMoralis();\n  const user = Moralis.User.current();\n  const {\n    fetch\n  } = useMoralisQuery(\"Messages\", query => query.equalTo(\"uid\", localStorage.getItem(\"id\")), [], {\n    autoFetch: false\n  });\n\n  async function like(id) {\n    await localStorage.setItem(\"id\", id);\n    console.log(localStorage.getItem(\"id\"));\n    fetch({\n      onSuccess: results => {\n        let likebuttons = results.map(e => {\n          let resultsi = e;\n          console.log(resultsi.attributes.uid);\n\n          if (resultsi.attributes.uid == localStorage.getItem(\"id\")) {\n            let likevalue = resultsi.attributes.likes;\n            let likelist = resultsi.attributes.likelist;\n            let likelistsplit = likelist.split(\"§\");\n\n            if (likelistsplit.includes(user.attributes.ethAddress) == false) {\n              likevalue += 1;\n              likelistsplit.push(user.attributes.ethAddress);\n              console.log(e);\n              e.set(\"likes\", likevalue);\n              e.set(\"likelist\", likelistsplit.join(\"§\"));\n              e.save();\n            } else {\n              likevalue -= 1;\n              const index = likelistsplit.indexOf(user.attributes.ethAddress);\n\n              if (index > -1) {\n                likelistsplit.splice(index, 1);\n              }\n\n              console.log(e);\n              e.set(\"likes\", likevalue);\n              e.set(\"likelist\", likelistsplit.join(\"§\"));\n              e.save();\n            }\n\n            document.getElementById(localStorage.getItem(\"id\")).innerText = likevalue;\n          }\n        });\n      },\n      onError: error => {\n        alert(error);\n      }\n    });\n  }\n\n  useEffect(() => {\n    async function getMessages() {\n      try {\n        let queriy = new Moralis.Query('Messages');\n        let messageget = await queriy.subscribe();\n        messageget.on('create', object => {\n          getMessages();\n        });\n        const Messages = Moralis.Object.extend(\"Messages\");\n        const query = new Moralis.Query(Messages);\n\n        if (profile) {\n          query.equalTo(\"senderAcc\", account);\n        }\n\n        const results = await query.find();\n        setMessageArr(results);\n      } catch (error) {\n        console.error(error);\n      }\n    }\n\n    getMessages();\n  }, [profile]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: MessageArr === null || MessageArr === void 0 ? void 0 : MessageArr.map(e => {\n      return /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"feedEva\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: e.attributes.senderPfp ? e.attributes.senderPfp : defaultImgs[0],\n            className: \"profilePic\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"completeEva\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"who\",\n              children: [e.attributes.senderUsername.slice(0, 6), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"accWhen\",\n                children: `${e.attributes.senderAcc.slice(0, 4)}...${e.attributes.senderAcc.slice(38)} · \n                        ${e.attributes.createdAt.toLocaleString('en-us', {\n                  month: 'short'\n                })}  \n                        ${e.attributes.createdAt.toLocaleString('en-us', {\n                  day: 'numeric'\n                })}\n                        `\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 98,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 96,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"evaContent\",\n              children: [e.attributes.messageTxt, e.attributes.messageImg && /*#__PURE__*/_jsxDEV(\"img\", {\n                src: e.attributes.messageImg,\n                className: \"evaImg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 109,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 106,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"interactions\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"interactionNums\",\n                children: /*#__PURE__*/_jsxDEV(Icon, {\n                  fill: \"#3f3f3f\",\n                  size: 20,\n                  svg: \"messageCircle\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 117,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 116,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                id: e.attributes.uid,\n                onClick: () => like(e.attributes.uid),\n                className: \"interactionNums\",\n                children: [/*#__PURE__*/_jsxDEV(Icon, {\n                  fill: \"#3f3f3f\",\n                  size: 20,\n                  svg: \"star\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 120,\n                  columnNumber: 21\n                }, this), e.attributes.likes]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"interactionNums\",\n                children: /*#__PURE__*/_jsxDEV(Icon, {\n                  fill: \"#3f3f3f\",\n                  size: 20,\n                  svg: \"matic\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 123,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }, this)\n      }, void 0, false);\n    }).reverse()\n  }, void 0, false);\n};\n\n_s(MessageInFeed, \"y8bBuw/6a1Kjb/yULxx178yMim0=\", false, function () {\n  return [useMoralis, useMoralisQuery];\n});\n\n_c = MessageInFeed;\nexport default MessageInFeed;\n\nvar _c;\n\n$RefreshReg$(_c, \"MessageInFeed\");","map":{"version":3,"names":["React","defaultImgs","Icon","useMoralis","useMoralisQuery","useEffect","useState","MessageInFeed","profile","MessageArr","setMessageArr","Moralis","account","user","User","current","fetch","query","equalTo","localStorage","getItem","autoFetch","like","id","setItem","console","log","onSuccess","results","likebuttons","map","e","resultsi","attributes","uid","likevalue","likes","likelist","likelistsplit","split","includes","ethAddress","push","set","join","save","index","indexOf","splice","document","getElementById","innerText","onError","error","alert","getMessages","queriy","Query","messageget","subscribe","on","object","Messages","Object","extend","find","senderPfp","senderUsername","slice","senderAcc","createdAt","toLocaleString","month","day","messageTxt","messageImg","reverse"],"sources":["C:/Users/Lahcen Laayouni/Documents/Eva/src/components/MessageInFeed.js"],"sourcesContent":["import React from \"react\";\nimport './MessageInFeed.css';\nimport {defaultImgs} from \"../defaultimgs\"\nimport {Icon} from \"web3uikit\"\nimport { useMoralis, useMoralisQuery } from \"react-moralis\";\nimport { useEffect, useState } from \"react\";\nconst MessageInFeed = ({profile}) => {\n  const [MessageArr, setMessageArr] = useState();\n  const {Moralis, account} = useMoralis();\n  const user = Moralis.User.current();\n  const { fetch } = useMoralisQuery(\n    \"Messages\",\n    (query) => query.equalTo(\"uid\", localStorage.getItem(\"id\")),\n    [],\n    { autoFetch: false}\n  );\n  \n  async function like(id){\n    await localStorage.setItem(\"id\", id)\n    console.log(localStorage.getItem(\"id\"))\n    fetch({\n      \n      onSuccess: (results) => {\n        let likebuttons = results.map((e) =>{\n          let resultsi = e\n          console.log(resultsi.attributes.uid)\n          if(resultsi.attributes.uid == localStorage.getItem(\"id\")){\n            let likevalue = resultsi.attributes.likes\n          let likelist = resultsi.attributes.likelist\n          let likelistsplit = likelist.split(\"§\")\n          if(likelistsplit.includes(user.attributes.ethAddress) == false){\n            likevalue += 1\n            likelistsplit.push(user.attributes.ethAddress)\n            console.log(e)\n            e.set(\"likes\", likevalue)\n            e.set(\"likelist\", likelistsplit.join(\"§\"))\n            e.save()\n          }else{\n            likevalue -= 1\n            const index = likelistsplit.indexOf(user.attributes.ethAddress);\n            if (index > -1) {\n              likelistsplit.splice(index, 1);\n            }\n            console.log(e)\n            e.set(\"likes\", likevalue)\n            e.set(\"likelist\", likelistsplit.join(\"§\"))\n            e.save()\n          }\n          \n          \n          document.getElementById(localStorage.getItem(\"id\")).innerText = likevalue\n          }\n          \n          \n\n        })\n        \n      },\n      onError: (error) => {\n        alert(error)\n      },\n    });\n   \n  }\n  useEffect(() => {\n    \n    async function getMessages() {\n      try {\n        let queriy = new Moralis.Query('Messages');\n        let messageget = await queriy.subscribe();\n        messageget.on('create', (object) => {\n          getMessages()\n        });\n        const Messages = Moralis.Object.extend(\"Messages\");\n        const query = new Moralis.Query(Messages);\n        if (profile) {\n          query.equalTo(\"senderAcc\", account);\n        }\n        const results = await query.find();\n        setMessageArr(results);\n      } catch (error) {\n        console.error(error);\n      }\n    }\n    getMessages();\n  }, [profile]);\n  \n  return (\n    <>\n    {MessageArr?.map((e) => {\n        return (\n          <>\n            <div className=\"feedEva\">\n              <img src={e.attributes.senderPfp ? e.attributes.senderPfp : defaultImgs[0]} className=\"profilePic\"></img>\n              <div className=\"completeEva\">\n                <div className=\"who\">\n                {e.attributes.senderUsername.slice(0, 6)}\n                  <div className=\"accWhen\">{\n                        `${e.attributes.senderAcc.slice(0, 4)}...${e.attributes.senderAcc.slice(38)} · \n                        ${e.attributes.createdAt.toLocaleString('en-us', { month: 'short' })}  \n                        ${e.attributes.createdAt.toLocaleString('en-us', { day: 'numeric' })}\n                        `  \n                      }\n                      </div>\n                </div>\n                <div className=\"evaContent\">\n                {e.attributes.messageTxt}\n                {e.attributes.messageImg && (\n                        <img\n                          src={e.attributes.messageImg}\n                          className=\"evaImg\"\n                        ></img>\n                      )}\n                </div>\n                <div className=\"interactions\">\n                  <div className=\"interactionNums\">\n                    <Icon fill=\"#3f3f3f\" size={20} svg=\"messageCircle\" />\n                  </div>\n                  <div id={e.attributes.uid} onClick={() => like(e.attributes.uid)} className=\"interactionNums\">\n                    <Icon fill=\"#3f3f3f\" size={20} svg=\"star\" />{e.attributes.likes}\n                  </div>\n                  <div className=\"interactionNums\">\n                    <Icon fill=\"#3f3f3f\" size={20} svg=\"matic\" />\n                  </div>\n                </div>\n              </div>\n            </div>\n          </>\n        );\n      }).reverse()}\n    </>\n  );\n};\nexport default MessageInFeed;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}